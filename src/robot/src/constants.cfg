name = "Runtime constants";

motion = 
{
  limit_max_fraction  = 0.8;   // Only generate a trajectory to this fraction of max speed to give motors headroom to compensate
  controller_frequency  = 40 ;   // Hz for RobotController
  log_frequency         = 20 ;   // HZ for logging to motion log
  translation = 
  {
    max_vel = 
    {
      fine   = 0.08; // m/s
      coarse = 0.2;  // m/s
    };
    max_acc = 
    {
      fine   = 0.1;  // m/s^2
      coarse = 0.5;  // m/s^2
    };
    max_jerk = 
    {
      fine   = 0.5;  // m/s^3
      coarse = 1.0;  // m/s^3
    };
    gains =
    {
      kp = 2;
      ki = 0.1;
      dk = 0;
    };
    position_threshold = 
    {
      fine = 0.01;   // m
      coarse = 0.10; // m
    };
    velocity_threshold = 
    {
      fine = 0.01;   // m/s
      coarse = 0.05; // m/s
    };
  };

  rotation = 
  {
    max_vel = 
    {
      fine   = 0.5;  // rad/s
      coarse = 1.0;  // rad/s
    };
    max_acc = 
    {
      fine   = 0.5;  // rad/s^2
      coarse = 1.0;  // rad/s^2
    };
    max_jerk = 
    {
      fine   = 1.0;  // rad/s^3
      coarse = 2.0;  // rad/s^3
    };
    gains =
    {
      kp = 3;
      ki = 0.5;
      dk = 0;
    };
    position_threshold = 
    {
      fine = 0.02;   // rad
      coarse = 0.08; // rad
    };
    velocity_threshold = 
    {
      fine = 0.01;   // rad/s
      coarse = 0.05; //rad/s
    };
  };
};

physical = 
{
  wheel_diameter = 0.152;  // m
  wheel_dist_from_center = 0.4794; // m
};

trajectory_generation = 
{
  solver_max_loops   = 10;    // Only let the solver loop this many times before giving up
  solver_alpha_decay = 0.8;   // Decay for velocity limit
  solver_beta_decay  = 0.8;   // Decay for acceleration limit
};

tray = 
{
  default_pos_steps = 50;    // Default position for driving in steps from home
  load_pos_steps    = 5;     // Loading position in steps from home
  place_pos_steps   = 100;    // Placing position in steps from home
};

localization = 
{
  mm_update_fraction = 0.2;    // Controls how much a new marvelmind reading updates the position
  mm_update_vel_fn_slope = -7.0;    // Slope of function that takes total velocity and maps to update confidence
  mm_update_vel_fn_intercept = 0.7;  // Y intercept of function that takes total velocity and maps to update confidence
};

mock_socket = 
{
  enabled = true;
  // Commands must have <> symbols and a number is to pause for that many ms
  data = ["5000", "<{'type':'move_rel','data':{'x':0.5,'y':0,'a':0}}>", "5000", "<{'type':'estop'}>"];
};
